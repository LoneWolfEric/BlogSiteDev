---
title: "纪念第一次参加技术类比赛：船模大赛"
date: 2018-05-16
categories:  Embedded
thumbnail: img/others/1526477179153.jpeg
tags: 
	- 嵌入式
	- 控制 
	- 比赛
toc: true
---

做个船模比赛心好累

# 前期调试

---

比赛前三周开始调模块，主控芯片采用stm32f407，通讯采用蓝牙串口模块，没用24L01的原因是......没调出来；电机采用2212无刷电机。不得不说，在所有的模块调试里面，通讯是最麻烦的：电机、舵机、两路ADC花了半天就调好了，通讯调了一天半。

看似把模块组合在一起很简单，但这就是硬件玄学的地方。

# 初赛

---

## 爆肝调船！

由于之前没有调过无刷电机（抱歉菜到大家了），一直不知道怎么对频。还是靠着电子科技园的陈大佬带我学会了对频。整个船差不多多能跑起来已经是比赛前一天下午了。但是还是有bug-通讯卡死问题。

bug没调完，那怎么办呢？当然是熬夜爆肝调啦！

![IMG_20180330_223823](my-first-model-boat-race/IMG_20180330_223823.jpg)

收拾下桌子开始干活！

![IMG_20180331_003516](my-first-model-boat-race/IMG_20180331_003516.jpg)

![IMG_20180331_055250](my-first-model-boat-race/IMG_20180331_055250.jpg)

不得不说，ddl是第一生产力，一个晚上让船的电机舵机联调成功，使用暴力手段解决了通讯卡死问题，调完了一套备用的蓝牙串口模块（HC-12）

然而......第二天比赛却因为下雨而推迟了一天.......迟了一天.......了一天.......一天.......天.......

本来多了一天，以为能让船下水的，结果出现了电机无法调速的bug，在调试的时候把电池电用光了，而且电池被我们榨干用坏了，充不进去电。队友小姐姐就跑出去买电池了。

![1410803219](my-first-model-boat-race/1410803219.jpeg)

## 下水

比赛当天才是第一次下水，上午评完外观分（我们的船叫Aurora，嘻嘻），下午我们自己试船（离比赛开始只有4h）。

没做过船模，不了解电机性能，第一次试的时候，舵机初始化的时候是歪的，h2212的动力太大，我自己操作也不熟悉，推动摇杆，船直接飞了出去。船飞到岸上，把自己的肚子撞裂了......（韵阳小姐姐抱起我们的船跑回去修）

简单地用热熔胶糊上了裂口处，我们的船又下水了，为了防止船出bug，我们给船装上了安全绳：当船动不了的时候还可以手动把船拉回来。然后一出船，舵机方向还是没摆正，水中乱绕了几圈之后不动了。这时！安全绳的作用就体现了出来。可是不拉不要紧，一拉，由于船受到的是侧面的力，我们的Aurora直接侧翻倒在了水中......

翻船了之后我们以最快的速度把船拉了回来（电子元件在通电的情况下进水是大忌！），但还是晚了一步。蓝牙的灯已经不亮了，烧模块了哇！但是我还有前面一次调完的HC-12模块，但当时由于卡死问题更严重，所以没有使用。当时情况紧急，心态有点乱，本来也是有HC-05的，但是AT指令输进去之后没有配对成功，心态爆炸。这时也只能死马当活马医了，换上了新的通讯模块之后，电机不转了......

![IMG_20180323_125722](my-first-model-boat-race/IMG_20180323_125722.jpg)

电机不转也可以说是电调的问题，本来在设置满油门的时候需要设置初始化，设置完一次之后就不用再设置了，但现在每次掉电之后都需要重新设置油门量程。

H2212实在是太强劲了，就跟脱缰的野马一样，速度太快，完全控制不住。这种比赛比的是稳定性，所以临时换电机，换成了动力较弱的A2212电机。

![IMG20180419200616](my-first-model-boat-race/IMG20180419200616.jpg)

缝缝补补总算是把下水发现的问题全改了。

## 赛场

![IMG20180421154125](my-first-model-boat-race/IMG20180421154125.jpg)

一直没时间去解决的是遥控器的电源问题，为了解决这个问题，本项目组采用了“基于surface pro3的船模遥控系统”。好吧，其实就是用电脑的usb供电。

![IMG_20180401_182739](my-first-model-boat-race/IMG_20180401_182739.jpg)

作为一个操作手，我的练习时间还是太少了，但是我们的船跑的慢啊，按错一个键也没啥关系，往回拉就没事了。初赛只是想苟过去，最后的晋级名单也验证了我的想法－所有跑完赛道的船全都进决赛了。

![IMG_20180401_124840](my-first-model-boat-race/IMG_20180401_124840.jpg)

![IMG_20180401_184633](my-first-model-boat-race/IMG_20180401_184633.jpg)

# 决赛

先是用两块3.7v电池和5v稳压模块解决了遥控器供电的问题（总算不用抱着电脑开船了），然后莫名奇妙的就调好了H2212电机和电调，但是在之后某次调船的时候电调进水烧掉了。

![IMG_20180413_161604](my-first-model-boat-race/IMG_20180413_161604.jpg)

![IMG_20180413_161614](my-first-model-boat-race/IMG_20180413_161614.jpg)

这个时候船主要的问题就是通信，蓝牙通信实在太不稳定，距离太近了，淘宝界面说的500+m都没问题，实际跑起来10m撑死。导致我们调船的时候经常出现船跑到一半停湖中间了，然后我就脱鞋赤脚下去捞......

电调烧了之后电机和电调就莫名其妙的没法跑了，我也是头铁，不撞南墙不回头。但是无刷电机还是没有调出来。直到赛前一天才打算临时换方案：使用775有刷电机作为动力源，还好配套的联轴器。

![IMG_20180421_010516](my-first-model-boat-race/IMG_20180421_010516.jpg)

实验室里现场改代码，但是一个引脚的pwm波总是出不来，但没有什么好的调试方法--我根本没法知道波形到底出来没有。so我们把电子科技园的示波器搬回了寝室！（最后是发现高级定时器初始化的时候还要对于pwm使能多配置一个东西）

![IMG_20180421_021213](my-first-model-boat-race/IMG_20180421_021213.jpg)

临时改方案当然是要通宵改了，为了防止自己躺床上起不来但又想睡觉只能这样做了：

![IMG_20180421_030142](my-first-model-boat-race/IMG_20180421_030142.jpg)

所以当时下午3点比赛，上午还要进行技术测评，测评完就来到极客邦调，无法解决有刷电机的调速问题，于时用示波器来看去驱动板输出波形，结果不小心探头抖了一下，然后就......

![IMG_20180421_140608_HDR](my-first-model-boat-race/IMG_20180421_140608_HDR.jpg)

## 决赛赛场

赛前发现船转向速度有点慢，然后......校园卡就决定是你了！

![IMG_20180421_170621](my-first-model-boat-race/IMG_20180421_170621.jpg)

由于是临时换的电机，也没有电机固定支架之类的，所以就只能用胶带勉强固定一下。

为了测试电机有没有转反，我和两位小姐姐进了女厕用厕所里洗手盆的水测试转反没有，中途又有另一位小姐姐进来，看到我在里面，那场面......

开船的时候嘛emmmmm船前半段跑的好好的，结果跑到一半船没法跑了，动了下舵机的功能，发现能动，那就是电机的问题了。喊了船爹妈之后终于是动了起来，但是船就是动一下然后停很久。但最后也总算是跑完了全程。

还有一次重赛的机会，知道船出了问题之后下来立马对船进行抢修，一看驱动板烧了，开始换驱动板，可惜焊锡和驱动板的大端口质量不好也没装上去。

最后发现其实是胶带的锅，胶带固定的不牢，电机转动的时候把胶带卷进去了，然后电机长时间堵转，导致驱动板烧毁。

![IMG_20180421_180229](my-first-model-boat-race/IMG_20180421_180229.jpg)

---

# 其他

---

做了比赛才知道自己有多么的菜，但是反观这个比赛，我们发现基础功能才是最重要的，初赛的时候只要是能跑的船就能进决赛，决赛专业组也是只要跑完全程就能有奖。

![假装有合照](my-first-model-boat-race/362040275.jpeg)